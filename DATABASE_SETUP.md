# Инструкция по настройке базы данных

## Шаг 1: Создание базы данных

1. Откройте **phpMyAdmin** в браузере: `http://localhost/phpmyadmin`
2. Войдите с учетными данными MySQL (обычно `root` без пароля для XAMPP)
3. Откройте вкладку **SQL**
4. Скопируйте содержимое файла `database_schema.sql`
5. Вставьте в поле SQL запроса
6. Нажмите **Выполнить**

Или выполните через командную строку:
```bash
mysql -u root -p < database_schema.sql
```

## Шаг 2: Проверка создания таблиц

После выполнения SQL скрипта проверьте, что созданы следующие таблицы:

- ✅ `users` - Пользователи
- ✅ `categories` - Категории товаров
- ✅ `products` - Товары
- ✅ `product_configs` - Конфигурации товаров
- ✅ `config_options` - Опции конфигураций
- ✅ `orders` - Заказы
- ✅ `order_items` - Товары в заказах
- ✅ `reviews` - Отзывы
- ✅ `user_statistics` - Статистика пользователей
- ✅ `online_users` - Онлайн пользователи
- ✅ `user_carts` - Корзины пользователей
- ✅ `user_favorites` - Избранное
- ✅ `user_actions` - История действий

## Шаг 3: Настройка подключения к БД

Создайте файл `config.php` в корне проекта:

```php
<?php
// Конфигурация базы данных
define('DB_HOST', 'localhost');
define('DB_NAME', 'pc_salon');
define('DB_USER', 'root');
define('DB_PASS', '');
define('DB_CHARSET', 'utf8mb4');

// Подключение к базе данных
function getDBConnection() {
    try {
        $dsn = "mysql:host=" . DB_HOST . ";dbname=" . DB_NAME . ";charset=" . DB_CHARSET;
        $options = [
            PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
            PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
            PDO::ATTR_EMULATE_PREPARES => false,
        ];
        return new PDO($dsn, DB_USER, DB_PASS, $options);
    } catch (PDOException $e) {
        error_log("Database connection error: " . $e->getMessage());
        return null;
    }
}
?>
```

## Шаг 4: Импорт начальных данных

После создания таблиц можно импортировать товары из вашего приложения. Создайте скрипт для импорта или добавьте товары вручную через phpMyAdmin.

## Структура базы данных

### Основные таблицы:

1. **users** - Хранит информацию о пользователях
   - telegram_id (уникальный)
   - ФИО, телефон, адрес
   - Даты регистрации и активности

2. **products** - Все товары магазина
   - Связь с категориями
   - Цена, характеристики (CPU, GPU)
   - Изображения

3. **orders** - Заказы пользователей
   - Тип доставки (доставка/самовывоз)
   - Статусы заказа и оплаты
   - Контактная информация

4. **order_items** - Товары в заказах
   - Поддержка обычных товаров и конфигураций
   - JSON для хранения данных конфигураций

5. **reviews** - Отзывы пользователей
   - Связь с товарами и заказами
   - Модерация отзывов

6. **user_statistics** - Статистика по пользователям
   - Количество заказов
   - Общая сумма покупок
   - Любимая категория

7. **online_users** - Текущие онлайн пользователи
   - Отслеживание активных сессий
   - Текущая страница

### Дополнительные таблицы:

- **user_carts** - Сохранение корзин между сессиями
- **user_favorites** - Избранное пользователей
- **user_actions** - История действий для аналитики

## Дополнительные возможности

В комментариях SQL скрипта предложены дополнительные таблицы:
- Промокоды/скидки
- Уведомления
- Чат с поддержкой
- Логи ошибок
- Настройки системы
- Администраторы

## Следующие шаги

1. ✅ Создать базу данных
2. ⏳ Создать API endpoints для работы с БД
3. ⏳ Интегрировать API в frontend
4. ⏳ Настроить аутентификацию через Telegram
5. ⏳ Реализовать сохранение заказов в БД

